name: Openwrt Actions

on: 
  # push: 
  #   branches:
  #     - main
  #schedule:
  #  - cron: 30 13 * * 6
  workflow_dispatch:

env:
  UPLOAD_FIRMWARE: true
  UPLOAD_COWTRANSFER: true
  UPLOAD_WETRANSFER: true

jobs:
  Build_OpenWrt:
    runs-on: ubuntu-20.04
        
    steps:
    - name: Checkout
      uses: actions/checkout@main

    - name: Initialization environment
      env:
        DEBIAN_FRONTEND: noninteractive
      run: |
        chmod +x ${GITHUB_WORKSPACE}/SCRIPTS/*.sh
        ${GITHUB_WORKSPACE}/SCRIPTS/01_init_env.sh

    - name: GET_READY
      run: |
        ${GITHUB_WORKSPACE}/SCRIPTS/02_get_ready.sh

    - name: PREPAR_PACKAGE
      run: |
        cd ${OPENWRTDIR}/openwrt
        ${GITHUB_WORKSPACE}/SCRIPTS/03_prepare_package.sh 